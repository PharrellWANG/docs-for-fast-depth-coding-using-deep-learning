

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Encoder Integration in C++ &mdash; Fast Depth Coding Using Deep Learning 0.1.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="Fast Depth Coding Using Deep Learning 0.1.0 documentation" href="index.html"/>
        <link rel="next" title="Quick Memo" href="quick-memo.html"/>
        <link rel="prev" title="Time Cost of TF in C++" href="tf-speed.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Fast Depth Coding Using Deep Learning
          

          
          </a>

          
            
            
              <div class="version">
                0.1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Proposed Algorithm</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="proposed-algorithm.html">Proposed Algorithm</a></li>
</ul>
<p class="caption"><span class="caption-text">Data Processing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="data-collection.html">Data Collection</a></li>
<li class="toctree-l1"><a class="reference internal" href="data-statistics.html">Processing Steps and Statistics</a></li>
<li class="toctree-l1"><a class="reference internal" href="data-visu.html">Data Visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="edge-strength-analysis.html">Edge Strength Analysis</a></li>
</ul>
<p class="caption"><span class="caption-text">Model Training</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="training.html">Deep Learning</a></li>
</ul>
<p class="caption"><span class="caption-text">Model Evaluating</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="eval-model-08.html">Model trained from size 08x08</a></li>
<li class="toctree-l1"><a class="reference internal" href="eval-model-16.html">Model trained from size 16x16</a></li>
</ul>
<p class="caption"><span class="caption-text">Encoder Integration</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="tf-speed.html">Time Cost of TF in C++</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Encoder Integration in C++</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#pre-requisites">Pre-requisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="#integrate-the-model-into-htm">Integrate the model into HTM</a></li>
<li class="toctree-l2"><a class="reference internal" href="#devices">Devices</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#device-for-data-processing">Device for Data Processing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#device-for-training-models">Device for Training Models</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Quick Memo</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="quick-memo.html">Quick Memo</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Fast Depth Coding Using Deep Learning</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Encoder Integration in C++</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/integration.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="encoder-integration-in-c">
<h1>Encoder Integration in C++<a class="headerlink" href="#encoder-integration-in-c" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><strong>Tensorflow r1.1</strong> is used in this work. (Tensorflow r1.3 is the newest stable version; Tensorflow r1.1 is the last version that Tensorflow supports Mac GPU.)</li>
<li><strong>macOS</strong> is used in this work.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Linux desktop with GPU is highly recommended (Windows OS is not recommended). (Ubuntu is the first choice since it has the largest community support.)</p>
</div>
<div class="section" id="pre-requisites">
<h2>Pre-requisites<a class="headerlink" href="#pre-requisites" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><a class="reference external" href="https://www.tensorflow.org/versions/r1.1/install/install_sources">Build tensorflow from source</a></li>
<li><a class="reference external" href="https://github.com/FloopCZ/tensorflow_cc">Build shared library for using the TensorFlow C++ library</a></li>
</ol>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><strong>Archive/Static library</strong> (.a) VS <strong>Shared library</strong> (.so)</p>
<p><em>Archive libraries</em> (.a) are statically linked i.e when you compile your program with -c option in gcc. So, if there’s any change in library, you need to compile and build your code again.</p>
<p class="last">The advantage of .so (<em>shared object</em>) over .a library is that <em>they are linked during the runtime</em>, i.e. after creation of your .o file -o option in gcc. So, if there’s any change in .so file, you don’t need to recompile your main program. But make sure that your main program is linked to the new .so file with in command.</p>
</div>
</div>
<div class="section" id="integrate-the-model-into-htm">
<h2>Integrate the model into HTM<a class="headerlink" href="#integrate-the-model-into-htm" title="Permalink to this headline">¶</a></h2>
<p>Download codebase from GitHub: <a class="reference external" href="https://github.com/PharrellWANG/HTM162-Bazel-Cmake">https://github.com/PharrellWANG/HTM162-Bazel-Cmake</a></p>
<p>There are two Apps in the above project.</p>
<ul class="simple">
<li>TAppClassifier</li>
<li>TAppEncoder</li>
</ul>
<p><strong>TAppClassifier</strong> is the skeleton code which can help you understand how to
load graph in C++ and run the prediction using Tensorflow.
It is a self-contained c++ Application which can be built from both
Bazel and CMake.</p>
<p>ResNet engine has been integrated to <strong>TAppEncoder</strong> for
<em>depth map angular modes [2, 34] prediction</em> and <em>the DMM1 searching process</em>.</p>
<p>For the DMM1 searching process, we are making use of wedgelet slope to reduce
the number of wedgelet candidates to be evaluated in DMM1 searching process.
If top-16 is used, then almost half of the candidates will be skipped.
Hence the time reduction for wedgelet decision shall be reduced roughly by half.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If have time, try to estimate the time cost of ResNet size [4, 4, 8, 16], units 3.
Prediction accuracy will be decreased by 2%~3%. But since flops
has been reduced from 600k to 130k,
the speed of prediction in c++ should be faster.</p>
</div>
</div>
<div class="section" id="devices">
<h2>Devices<a class="headerlink" href="#devices" title="Permalink to this headline">¶</a></h2>
<div class="figure" id="id1">
<a class="reference internal image-reference" href="_images/devices.JPG"><img alt="Devices" src="_images/devices.JPG" style="width: 300px;" /></a>
<p class="caption"><span class="caption-text">Devices for this project</span></p>
</div>
<div class="section" id="device-for-data-processing">
<h3>Device for Data Processing<a class="headerlink" href="#device-for-data-processing" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>iMac (21.5-inch 2017)</strong></li>
<li>Processor 3GHz Intel Core i5</li>
<li>Memory 8GB 2400 MHz DDR4</li>
</ul>
</div>
<div class="section" id="device-for-training-models">
<h3>Device for Training Models<a class="headerlink" href="#device-for-training-models" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>Macbook Pro (15-inch, Mid 2015)</strong></li>
<li>Processor 2.2GHz Intel Core i7</li>
<li>Memory 16GB 1600MHz DDR3</li>
<li>Nvidia GTX980, Memory 4GB (External GPU)</li>
</ul>
<p>Thank you for reading.</p>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="quick-memo.html" class="btn btn-neutral float-right" title="Quick Memo" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="tf-speed.html" class="btn btn-neutral" title="Time Cost of TF in C++" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Pharrell.zx WANG.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>